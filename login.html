<!DOCTYPE html>
<!--
  Google API Client id:11039513244997-gmo5aho352m4ukl69brqi3uj7pha2gjd.apps.googleusercontent.com
  Google API Client Secret : 
-->
<html lang="en" dir="ltr">
  <head>
    <title> Facebook / Google login </title>
    <meta charset="utf-8">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
    <script src="https://apis.google.com/js/platform.js" async defer></script>
    <!--
    <meta name="google-signin-client_id" content="1039513244997-gmo5aho352m4ukl69brqi3uj7pha2gjd.apps.googleusercontent.com">
    -->

    <!----------------------------- Facebook --------------------------------------------->
    <script> // facebook login
      console.log("script==> facebook");

      (function(d, s, id) {                      // Load the SDK asynchronously
      var js, fjs = d.getElementsByTagName(s)[0];
      if (d.getElementById(id)) return;
      js = d.createElement(s); js.id = id;
      js.src = "https://connect.facebook.net/en_US/sdk.js";
      fjs.parentNode.insertBefore(js, fjs);
      }(document, 'script', 'facebook-jssdk'));


      var checkLoginStatus = function(response) { 
        console.log(response);

        if (response.status === 'connected'){
          document.querySelector('#authBtn').value='Logout';
          /* make the API call */
          FB.api(
              "/me",
              function (resp) {
                document.querySelector('#name').innerHTML = resp.name;
              }
          );

        } else {
          document.querySelector('#authBtn').value='Login';
          document.querySelector('#name').innerHTML = "";

        }
      }

				window.fbAsyncInit = function() {
		FB.init({
			appId      : '295942368107428',
			cookie     : true,                     // Enable cookies to allow the server to access the session.
			xfbml      : true,                     // Parse social plugins on this webpage.
			version    : 'v7.0'           // Use this Graph API version for this call.
		});


		  FB.getLoginStatus(checkLoginStatus);

		//FB.getLoginStatus(function(response) {   // Called after the JS SDK has been initialized.
		//	statusChangeCallback(response);        // Returns the login status.
		//});
	};


	  </script>

    <!----------------------------- Google --------------------------------------------->

    <script type="text/javascript">

/*
// Google Auth2

  function onSignIn(googleUser) {
  var profile = googleUser.getBasicProfile();
  console.log('ID: ' + profile.getId()); // Do not send to your backend! Use an ID token instead.
  console.log('Name: ' + profile.getName());
  console.log('Image URL: ' + profile.getImageUrl());
  console.log('Email: ' + profile.getEmail()); // This is null if the 'email' scope is not present.
}

// Google Auth2
*/

      function checkLoginGoogStatus() {
        var loginBtn = document.querySelector('#loginBtn');
        val googlename = document.querySelector('#googlename');

                if(gauth.isSignedIn.get()){
                  console.log("logined");
                  loginBtn.value = 'logout';
                  var profile = gauth.currentUser.get().getBasicProfile();
                  console.log(profile.getName());
                  googlename.innerHTML = 'Welcome <strong>' + profile.getName() + '</strong> ';

                } else {
                  console.log("already logout")
                  loginBtn.value = 'login';
                  googlename.innerHTML = '';

                }
      }

      function init() {
          gapi.load('auth2', function() {
            /* Ready. Make a call to gapi.auth2.init or some other API */

              window.gauth = gapi.auth2.init({
                    client_id:'1039513244997-gmo5aho352m4ukl69brqi3uj7pha2gjd.apps.googleusercontent.com'
              });

              gauth.then(function(){
                console.log('google auth success');
                checkLoginGoogStatus();
              }, function(){
                console.log('google auth failed');
              });

          });
      }

    </script>

  </head>


  <body>

 <!----------------------------- Google --------------------------------------------->
    <p> Google  login test 1.49 </p>
    <span id='googlename'></span>

    <input type="button" id="loginBtn" value="checking...." onclick="
        if (this.value === 'login') {
          gauth.signIn().then(function() {
              console.log('gauth.signIn()');
              checkLoginGoogStatus();
          });
        } else {
          gauth.signOut().then(function() {
              console.log('gauth.signOut()');
              checkLoginGoogStatus();
          });
        }
        ">
    <script type="text/javascript"> console.log("pass Google login test");</script>

    <!--
    <div class="g-signin2" data-onsuccess="onSignIn"></div>
  -->

 <!----------------------------- FaceBook -------------------------------------------->

    <p> facebook login test </p>
    <div id='name'> </div>

    <input type="button" id="authBtn" value="checking..." onclick="
console.log('value==>');
      if(this.value === 'Login'){
        //now Logout
        FB.login(function(response){
          // handle the response
          console.log('login==>', response);
          checkLoginStatus(response);
        });
      } else {
        // now Login
console.log('logout==>');
        FB.logout(function(response) {
          // Person is now logged out

          checkLoginStatus(response);
        });
      }
      ">

<!--
      <input type="button" id="authBtn" value="checking..." onclick="
       if(this.value === 'Login'){
         // now logout
         FB.login(function(res){
           console.log('login =>', res);
          // checkLoginStatus(res);
         });
       } else {
         // now login
         FB.logout(function(res){
           console.log('logout =>', res);
          // checkLoginStatus(res);
         });
       }
   ">
-->

<script src="https://apis.google.com/js/platform.js?onload=init" async defer></script>

<a href='https://accounts.google.com/o/oauth2/v2/auth?
 scope=https%3A//www.googleapis.com/auth/drive.metadata.readonly&
 include_granted_scopes=true&
 response_type=token&
 state=state_parameter_passthrough_value&
 redirect_uri=https%3A%2F%2Fjuhane.github.io%2Fbloomfield%2Flogin.html&
 client_id=1039513244997-gmo5aho352m4ukl69brqi3uj7pha2gjd.apps.googleusercontent.com'> Login with Google Oauth 2.0 </a>
  </body>
</html>
